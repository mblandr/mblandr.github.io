function weaklyFeatures() {
  if (window.matchMedia('(max-width: 910px)').matches) {
    $('.weekly-features .product').addClass('product--preview').removeClass('product--2col')
  } else {
    $('.weekly-features .product').addClass('product--2col').removeClass('product--preview')
  }
}

function categoryPage() {
  productsOfCategory = $('.category__list--listview .product');
  if (window.matchMedia('(max-width: 800px)').matches) {
    productsOfCategory.removeClass('product--3col')
  } else {
    productsOfCategory.addClass('product--3col')
  }
}


function dropdown(menu, button) {
  menu = $(menu);
  button = $(button);

  button.click(function (event) {
    menu.slideToggle();
    event.stopPropagation();
  });

  menu.find('a, button').click(function (event) {
    menu.slideToggle();
    event.stopPropagation();
  });

  $(window).click(function (event) {
    if (!(event.target == menu)) {
      menu.slideUp()
    }
  });

}

$(function () {

  dropdown('.dropdown-newest', '.newest__filter-dropdown');


  new Swiper('.followers-slider.swiper-container', {
    slidesPerView: 3,
    spaceBetween: 20,
    loop: true,
    navigation: {
      nextEl: '.followers .slider-nav__btn--next',
      prevEl: '.followers .slider-nav__btn--prev',
    },

    breakpoints: {
      100: {
        slidesPerView: 1,
        spaceBetween: 0,
      },
      800: {
        slidesPerView: 2,
        spaceBetween: 40,
      },
      1100: {
        slidesPerView: 3,
        spaceBetween: 50,
      },
    }
  });
  new Swiper('.features-slider.swiper-container', {
    slidesPerView: 1,
    spaceBetween: 0,
    loop: true,
    effect: 'fade',
    navigation: {
      nextEl: '.weekly-features .slider-nav__btn--next',
      prevEl: '.weekly-features .slider-nav__btn--prev',
    },
  });

  //mixitup
  if ($('.newest__products').length)
    mixitup('.newest__products');
  if ($('.category__list').length)
    mixitup('.category__list');


  $('.promo__select-category').styler();
  $('.category__option-select-order').styler();
  $('.category__option-select-per-page').styler();
  $('.category__option-select-filter').styler();
  //$('.sidebar__radio').styler();


  rangeSelector = $('.sidebar__pricing-range-slider');
  if (rangeSelector.length) {
    rangeSelector.ionRangeSlider({
      type: "double",
      skin: "round",
      prefix: "$",
      hide_min_max: true,
      hide_from_to: true,
      grid: false,
      onChange: function (data) {
        $('.sidebar__pricing-range--from').text('$' + data.from);
        $('.sidebar__pricing-range--to').text('$' + data.to);
      }
    });
  }

  $('.product__rating').each(function () {
    $(this).rateYo({
      readOnly: true,
      starWidth: '14px',
      spacing: '3px',
      halfStar: true,
      ratedFill: '#ffc000',
      normalFill: '#ffffff',
      "starSvg": "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>",
      rating: $(this).attr("data-rating"),
    })
  });

  $('.main-menu__btn').on('click', function () {
    $('.main-menu__list').slideToggle();
    $(this).toggleClass('active')
  });

  $(".user-panel__slide-btn").click(function () {
    $(".user-panel__icons").toggleClass('active')
  });


  gridBtn = $(".category__option-img--grid");
  listBtn = $(".category__option-img--list");
  list = $(".category__list");
  product = list.find('.product');

  $('.sidebar__title').click(function () {
    $(this).toggleClass('rotated-dropdown');
    $(this).next().slideToggle();
  })

  if (gridBtn.length)
    gridBtn.click(function () {
      gridBtn.addClass('active');
      listBtn.removeClass('active');
      list.addClass('category__list--gridview').removeClass('category__list--listview');
      product.addClass('product--short').removeClass('product--3col');
    });

  if (listBtn.length)
    listBtn.click(function () {
      listBtn.addClass('active');
      gridBtn.removeClass('active');
      list.addClass('category__list--listview').removeClass('category__list--gridview');
      product.addClass('product--3col').removeClass('product--short');
    });


  $('.dropdown-menu__header-link').click(function () {
    div = this;
    divJ = $(this);
    ul = divJ.next()[0];
    if (!ul)
      return;
    if (window.matchMedia('(max-width: 910px)').matches) {
      if (ul.style.display != 'none')
        divJ.parent().height(60);
      else {
        divJ.parent().height(divJ.height() + $(ul).height());
      }
      $(ul).slideToggle();
    } else if (window.matchMedia('(max-width: 1100px)').matches) {
      items = $('.dropdown-menu--large').find('.dropdown-menu__header-link + .main-menu__list');
      items.each(function (index, element) {
        if (element == ul)
          $(element).toggleClass('active');
        else
          $(element).removeClass('active');
      })
    }
  });

  $('.main-menu__link').click(function () {
    if (window.matchMedia('(max-width: 910px)').matches) {
      thisElement = $(this);
      current = thisElement.next()[0];
      if (!current)
        return;
      current = $(current);
      current.slideToggle();


    }
  });

  contents = $('.product-content__contents');

  $('.product-content__tab-header').click(function () {
    currentId = this.getAttribute("data-id");
    $('.product-content__tab-header').each(function (index, element) {
      Id = element.getAttribute("data-id");
      product = contents.find(`[data-id='${Id}']`)
      if (currentId == Id) {
        $(this).addClass('active');
        $(product).addClass('active');
      } else {
        $(element).removeClass('active')
        $(product).removeClass('active');
      }
    });
  });


  weaklyFeatures();
  categoryPage();

  $(window).resize(function () {
    weaklyFeatures();
    categoryPage();
  })


})
;

